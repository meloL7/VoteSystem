function validate(){if(1!=isUserValid&&userName&&userName.onblur&&userName.onblur(),1!=isPasswordValid&&password&&password.onblur&&password.blur(),(window.txtMobile||!confirmPassword)&&(isConfirmPasswordValid=!0),1!=isConfirmPasswordValid&&confirmPassword&&confirmPassword.onblur(),window.txtMobile){if(isEmailValid=!0,!txtMobile.hassended)return lbMsg.innerHTML="请先进行手机号码验证",!1;if(!txtCode.value)return lbMsg.innerHTML="请输入短信验证码",!1}else 1!=isEmailValid&&email.onblur();if(window.validateImage&&""==validateImage.value)return lbMsg.innerHTML="验证码不能为空",!1;var a=isEmailValid&&isConfirmPasswordValid;return a}function RegisterOnfocus(){$$("divUserNamePromptInfo").style.display="",$$("divUserNameErrorInfo").style.display="none",$$("divUserNameRightInfo").style.display="none"}function RegisterOnblur(){var a,b,c,d;return isUserValid=!1,$$("divUserNamePromptInfo").style.display="none",this.value?this.value.length>50?(validateUserMsg(4),void 0):(a=this.value,b=a.dbc2sbc(),a!=b&&(this.value=b),c=/^[a-zA-Z0-9_\@\.\-]{3,50}$/,d=/[A-Za-z]/,c.exec(this.value)?d.exec(this.value)?this.value.indexOf("--")>-1?(validateUserMsg(6),void 0):(XMLHttp.sendReq("get","/Handler/Register.ashx?type=u&keyword="+escape(this.value),"",OnValidateUser),void 0):(validateUserMsg(7),void 0):(validateUserMsg(5),void 0)):(validateUserMsg(1),void 0)}function OnValidateUser(a){var b=a.responseText;validateUserMsg(b)}function validateUserMsg(a){var b=document.getElementById("divUserNameErrorInfo");1==a||4==a||5==a||6==a||7==a?($$("divUserNameErrorInfo").style.display="",$$("divUserNamePromptInfo").style.display="none",$$("divUserNameRightInfo").style.display="none",1==a?b.innerHTML="用户名不能为空":4==a?b.innerHTML="用户名长度不能超过50":5==a?b.innerHTML="用户名只能包含英文，数字":6==a?b.innerHTML="用户名不能包含--符号":7==a&&(b.innerHTML="用户名必须包含字母")):2==a?($$("divUserNameErrorInfo").style.display="",$$("divUserNamePromptInfo").style.display="none",$$("divUserNameRightInfo").style.display="none",b.innerHTML="用户名已经被占用！"):3==a?($$("divUserNameErrorInfo").style.display="",$$("divUserNamePromptInfo").style.display="none",$$("divUserNameRightInfo").style.display="none",b.innerHTML="用户名不合法，请更换！"):($$("divUserNameErrorInfo").style.display="none",$$("divUserNamePromptInfo").style.display="none",$$("divUserNameRightInfo").style.display="",isUserValid=!0,window._czc&&_czc.push(["_trackEvent","注册输入用户名","PC端",""]))}function isPasswd(a){var b=/^(.){8,20}$/,c=/[a-zA-Z]+/,d=/[0-9]+/;return b.test(a)&&c.test(a)&&d.test(a)?!0:!1}function divPasswordPromptInfoRegisterOnfocus(){$$("divPasswordPromptInfo").style.display="",$$("divPasswordErrorInfo").style.display="none",$$("divPasswordRightInfo").style.display="none"}function divPasswordPromptInfoRegisterOnblur(){isPasswordValid=!1,$$("divPasswordPromptInfo").style.display="none",isPasswd(this.value)?($$("divPasswordErrorInfo").style.display="none",$$("divPasswordRightInfo").style.display="",isPasswordValid=!0):($$("divPasswordErrorInfo").style.display="",$$("divPasswordRightInfo").style.display="none")}function divConfirmPasswordPromptInfoRegisterOnfocus(){$$("divConfirmPasswordPromptInfo").style.display="",$$("divConfirmPasswordErrorInfo").style.display="none",$$("divConfirmPasswordRightInfo").style.display="none"}function divConfirmPasswordPromptInfoRegisterOnblur(){isConfirmPasswordValid=!1,$$("divConfirmPasswordPromptInfo").style.display="none",isPasswd(this.value)?this.value==password.value?($$("divConfirmPasswordErrorInfo").style.display="none",$$("divConfirmPasswordRightInfo").style.display="",isConfirmPasswordValid=!0):($$("divConfirmPasswordErrorInfo").style.display="",$$("divConfirmPasswordRightInfo").style.display="none"):($$("divConfirmPasswordErrorInfo").style.display="",$$("divConfirmPasswordRightInfo").style.display="none")}function divEmailPromptInfoRegisterOnfocus(){$$("divEmailPromptInfo").style.display="",$$("divEmailErrorInfo").style.display="none",$$("divEmailRightInfo").style.display="none"}function divEmailPromptInfoRegisterOnblur(){isEmailValid=!1,$$("divEmailPromptInfo").style.display="none";var a=/^[a-z0-9!#$%&'*+\/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&'*+\/=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?$/i;this.value.indexOf("@")>-1&&a.test(this.value)?XMLHttp.sendReq("get","/Handler/Register.ashx?type=e&keyword="+escape(this.value),"",OnValidateEmail):validateEmailMsg(1)}function OnValidateEmail(a){var b=a.responseText;validateEmailMsg(b)}function validateEmailMsg(a){var c,b=document.getElementById("divEmailErrorInfo");1==a?($$("divEmailErrorInfo").style.display="",$$("divEmailPromptInfo").style.display="none",$$("divEmailRightInfo").style.display="none",b.innerHTML="邮件地址格式输入错误！"):2==a?($$("divEmailErrorInfo").style.display="",$$("divEmailPromptInfo").style.display="none",$$("divEmailRightInfo").style.display="none",b.innerHTML="该邮件地址已经被占用！"):($$("divEmailRightInfo").style.display="",$$("divEmailPromptInfo").style.display="none",$$("divEmailErrorInfo").style.display="none",isEmailValid=!0,c=email.value,c.indexOf("@hotmail")>-1?($$("divEmailErrorInfo").innerHTML="提示：使用<b style='color:red;'>hotmail</b>可能会收不到邮件，建议更改！",$$("divEmailRightInfo").style.display="none",$$("divEmailErrorInfo").style.display=""):c.indexOf("@outlook")>-1&&($$("divEmailErrorInfo").innerHTML="提示：使用<b style='color:red;'>outlook</b>可能会收不到邮件，建议更改！",$$("divEmailRightInfo").style.display="none",$$("divEmailErrorInfo").style.display=""))}window.onload=function(){userName&&(userName.onfocus=RegisterOnfocus,userName.onblur=RegisterOnblur),password&&(password.onfocus=divPasswordPromptInfoRegisterOnfocus,password.onblur=divPasswordPromptInfoRegisterOnblur),email&&(email.onfocus=divEmailPromptInfoRegisterOnfocus,email.onblur=divEmailPromptInfoRegisterOnblur),confirmPassword&&(confirmPassword.onfocus=divConfirmPasswordPromptInfoRegisterOnfocus,confirmPassword.onblur=divConfirmPasswordPromptInfoRegisterOnblur),window.validateImage&&(validateImage.onblur=function(){var a=document.getElementById("spanImgMsg");a.innerHTML=this.value?"":"验证码不能为空"}),window._czc&&_czc.push(["_trackEvent","注册加载","PC端",""])},String.prototype.dbc2sbc=function(){return this.replace(/[\uff01-\uff5e]/g,function(a){return String.fromCharCode(a.charCodeAt(0)-65248)}).replace(/\u3000/g," ")};var XMLHttp={_objPool:[],_getInstance:function(){for(var a=0;a<this._objPool.length;a++)if(0==this._objPool[a].readyState||4==this._objPool[a].readyState)return this._objPool[a];return this._objPool[this._objPool.length]=this._createObj(),this._objPool[this._objPool.length-1]},_createObj:function(){var a,b,c;if(window.XMLHttpRequest)a=new XMLHttpRequest;else for(b=["MSXML2.XMLHTTP.5.0","MSXML2.XMLHTTP.4.0","MSXML2.XMLHTTP.3.0","MSXML2.XMLHTTP","Microsoft.XMLHTTP"],c=0;c<b.length;c++)try{a=new ActiveXObject(b[c]);break}catch(d){}return a},sendReq:function(method,url,data,callback){var rn,objXMLHttp=this._getInstance();with(objXMLHttp)try{rn=window.rndnum||(new Date).valueOf(),url+=url.indexOf("?")>0?"&randnum="+rn:"?randnum="+rn,open(method,url,!0),setRequestHeader("Content-Type","application/x-www-form-urlencoded; charset=UTF-8"),send(data),onreadystatechange=function(){4!=objXMLHttp.readyState||200!=objXMLHttp.status&&304!=objXMLHttp.status||callback(objXMLHttp)}}catch(e){alert(e)}}};